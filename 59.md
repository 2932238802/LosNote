1. 
select和epoll的区别

| 特性                   | `select`                                                 | `epoll`                                            |
| :--------------------- | :------------------------------------------------------- | :------------------------------------------------- |
| **工作模式**           | **轮询 (Polling)**                                       | **事件驱动 (Event-driven / Callback)**             |
| **文件描述符(FD)处理** | 每次调用都需**拷贝**全量FD集合到内核，**内核遍历**所有FD | 只需**注册一次**FD，内核通过回调维护一个“就绪”链表 |
| **性能复杂度**         | **O(N)**，N为监控的FD总数                                | **O(1)**，只处理活跃的FD                           |
| **最大连接数限制**     | **有上限**，受`FD_SETSIZE`限制 (通常是1024)              | **无硬性上限**，受限于系统内存                     |
| **内存拷贝**           | 每次调用都涉及用户空间和内核空间的大量拷贝               | 使用**共享内存(mmap)**，避免不必要的拷贝           |
| **触发模式**           | 仅支持**水平触发 (LT)**                                  | 支持**水平触发 (LT)** 和 **边缘触发 (ET)**         |

- [x] 11_20 左 r
- [ ] 11_19 右 



问： 这里的 fd是什么？

答：网络套接字

- [ ] 11_19 



2. 如何理解 水平触发 和 边缘触发

| 特性           | 水平触发 (LT)                        | 边缘触发 (ET)                                    |
| :------------- | :----------------------------------- | :----------------------------------------------- |
| **核心思想**   | 关心**状态** (缓冲区有数据)          | 关心**事件/变化** (数据刚刚到达)                 |
| **通知机制**   | 只要条件满足，**反复**通知           | 只有状态变化时，**通知一次**                     |
| **编程复杂度** | **低**，不易出错，更健壮             | **高**，必须一次性处理完，否则数据会滞留         |
| **效率**       | 相对较低（可能因反复通知而多次唤醒） | **非常高**，最大限度减少了`epoll_wait`的唤醒次数 |
| **典型应用**   | 大多数网络应用，Redis (早期版本)     | Nginx, libevent 等高性能网络库                   |

水平触发： 只要条件满足（缓冲区有数据）, 状态模式，宽容，只要条件满足，就会被反复提醒，即使你这次处理得不彻底，下次还会通知，不容易出错

边缘触发： 你只会被通过一次，收到通知后，你必须一次性把所有的事情做完，否则剩下的数据就会被遗忘，直到下一次新数据到来

- [ ] 11_19



3. epoll

- 优点：
  - 没有最大并发连接的限制
  - 不采取轮询方式，效率高，只处理活跃的连接
  - 使用回调机制，避免遍历所有的文件描述符，性能提升显著

- [x] 11_19



4. 

**select**的优点是实现简单，几乎所有操作系统都有对应的实现。然而，它也有一些缺点：

- 每次调用都需要将文件描述符集合从用户态拷贝到内核态，开销大。
- 内核遍历所有文件描述符集合，效率低。
- 文件描述符数量有限制（32位系统最多1024个，64位系统最多2048个）。

- [ ] 11_19



5. 

**epoll**提供了两种工作模式：



**水平触发（LT）**：默认模式，当事件就绪时，应用程序可以不立即处理，下次调用epoll_wait时会再次通知

- [x] 11_19
- [ ] 



**边缘触发（ET）**：高效模式，当事件就绪时，应用程序必须立即处理，否则不会再次通知

- [x] 11_19
- [ ] 



为什么 select 不支持 边缘触发？

答：调用前，需要手动创建一个fd_set把你所有关心的FD通过fd_set加进去

调用select（），你把这个fd_set传递给内核，select（）函数会阻塞，知道你关心的FD中至少有一个就绪

当然select（） 返回时，内核就会修改你传入的那个fd_set，把所有“未就绪”的FD从集合中移除，你得到的fd_set只剩下那些1当前处于就绪状态的FD

你需要遍历整个 fd_set 用fd_isset 来检查哪个FD仍然在集合里面，然后对它进行处理













