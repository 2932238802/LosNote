1. 

```php
<?php
/**
 * LosGate - PHP 版简易网关
 */

// 1. 定义路由映射表 (路由名 => 目标服务器地址)
$routes = [
    'auth' => 'http://127.0.0.1:3001', // 比如转发给你的 Rust 登录服务
    'user' => 'http://127.0.0.1:3002', // 比如转发给用户服务
];

// 2. 获取请求路径 (例如: /auth/login)
$uri = $_SERVER['REQUEST_URI'];
$parts = explode('/', trim($uri, '/'));
$serviceName = $parts[0] ?? ''; // 拿到 'auth'

// 3. 基础检查
if (!isset($routes[$serviceName])) {
    http_response_code(404);
    echo json_encode(["error" => "Service not found"]);
    exit;
}

// 4. 鉴权中间件 (假设只有 /auth 不需要 Token)
if ($serviceName !== 'auth') {
    $token = $_SERVER['HTTP_AUTHORIZATION'] ?? '';
    if ($token !== 'Bearer my-secret-token') {
        http_response_code(401);
        echo json_encode(["error" => "Unauthorized"]);
        exit;
    }
}

// 5. 核心：转发请求 (Proxy)
$targetUrl = $routes[$serviceName] . $uri;
$method = $_SERVER['REQUEST_METHOD'];
$payload = file_get_contents('php://input');

// 使用 cURL 发起转发请求
$ch = curl_init($targetUrl);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, $method);
curl_setopt($ch, CURLOPT_POSTFIELDS, $payload);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Content-Type: application/json',
    'X-Forwarded-By: LosGate-PHP' // 告诉后端这是网关转的
]);

$response = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
curl_close($ch);

// 6. 将结果返回给前端
http_response_code($httpCode);
header('Content-Type: application/json');
echo $response;


1. REQUEST_URI 是 $_SERVER的成员变量么？
2. 如何理解 ？explode
3. 如何理解 ？ isset
4. 这个 作用类似于 nginx？
5. 这个如何理解 $targetUrl = $routes[$serviceName] . $uri？
```

- $_SERVER 是一个关联数组，REQUEST_URL 是这个数组里的一个Key
- 如果访问 `http://localhost:8000/auth/login?id=1`
  - **`$_SERVER['REQUEST_URI']`** 拿到的就是 `/auth/login?id=1`

- [ ] 1_27



- explode

  - 把一个字符串按照某个分隔符，“炸开”成一个数组

  - ```php
    $uri = "/auth/login";
    $parts = explode('/', $uri);
    // 结果是数组：["", "auth", "login"]
    ```

  - [x] 26_1_27

    

  
  
  

- isset 用来检查一个Option 是不是存在且不为Null

  - ```php
    $arr = ["a" => 1];
    isset($arr["a"]); // 返回 true
    isset($arr["b"]); // 返回 false，这样程序就不会因为找不到 Key 而报错崩溃
    ```

  - [ ] 26_1_27

  

  

- 是的 作用类似于 nginx

- [x] 26_1_27



- `.`（点号）是 PHP 的字符串拼接符（Rust 里的 `+` 或 `format!`）

- [ ] 26_1_27



2. 智能指针的本质是什么，它们的实现原理是什么？
智能指针本质是一个封装了一个原始C++指针的类模板，为了确保动态内存的安全性而产生的。实现原理是通过一个对象存储需要被自动释放的资源，然后依靠对象的析构函数来释放资源

- [x] 26_1_27



3. 

匿名函数的本质是什么？他的优点是什么？
匿名函数本质上是一个对象，在其定义的过程中会创建出一个栈对象，内部通过重载()符号实现函数调用的外表。
优点：使用匿名函数，可以免去函数的声明和定义。这样匿名函数仅在调用函数的时候才会创建函数对象，而调用结束后立即释放，所以匿名函数比非匿名函数更节省空间

- [x] 26_1_27



4. 
C++中空类的大小是多少？
1字节



5. 

什么是 内存泄漏

**内存泄漏**：是指程序中以动态分配的堆内存由于某种原因程序未释放或无法释放，造成系统内存的浪费，导致程序运行速度减慢甚至系统崩溃等严重后果

- [x] 26_1_27
- [ ] 











