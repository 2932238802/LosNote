1. [rust]

- 模式 if 布尔表达式 => 执行代码

- ```rust
  let x = Some(50);
  
  match x {
      // 同样是 Some(v)，我可以分好几种情况写：
      
      // 情况 A: 有值，且大于 100
      Some(v) if v > 100 => println!("太大了: {}", v),
      
      // 情况 B: 有值，且是偶数
      Some(v) if v % 2 == 0 => println!("是偶数: {}", v),
      
      // 情况 C: 剩下的所有 Some 情况
      Some(v) => println!("普通数字: {}", v),
      
      // 情况 D: None
      None => println!("空的"),
  }
  
  ```

  



2.  [rust]

- 服务器的包
- use tokio::net::TcpListener;

- [x] 1_18



3. 

use tokio::net::TcpListener;


#[tokio::main]
async fn main(){
    let listener = TcpListener::bind("127.0.0.1:6379").await?;
}

这样为啥 报错？



- 因为 **`main` 的现状**：你写的 `async fn main()` 默认返回值是 `()` (空)。
- **冲突**：`?` 想扔出一个 `Err`，但 `main` 函数说：“我不收垃圾，我只收空”。类型对不上了





4. 

Box<dyn Error>
详细介绍一下 这个 Box 和 dyn
这个如果是智能指针和Arc的区别是？



- 当你写 `dyn Error` 时，你是在说：“我不在乎它原本是谁（是 IO 错误还是解析错误），我只把它当做一个实现了 Error 接口的对象来看待。”

- ### `Box` vs `Arc` —— “独占” vs “共享”

  它俩都是智能指针，都指向堆内存，区别在于**所有权**：

  | 特性       | **Box** (`Box<T>`)                                           | **Arc** (`Arc<T>`)                                    |
  | :--------- | :----------------------------------------------------------- | :---------------------------------------------------- |
  | **全称**   | Unique Pointer (独占指针)                                    | Atomic Reference Counting (原子引用计数)              |
  | **所有权** | **独裁者**。同一时间只能有一个主人。                         | **共享者**。可以有多个主人。                          |
  | **Move**   | 发生 `move` 时，盒子连同数据一起**移交**给新主人，旧主人失效。 | 发生 `clone` 时，数据不动，**复制一把钥匙**给新主人。 |
  | **开销**   | 极小（就一个指针）。                                         | 稍大（要维护引用计数，且原子操作有 CPU 开销）。       |
  | **用途**   | 用于**单线程**内转移数据，或**多态**（如 `Box<dyn Error>`）。 | 用于**多线程**间共享同一份数据（如你的数据库 `db`）。 |



- [x] 1_18



5. 

let (mut socket,addr)  = listener.accept().await?;

如何理解这个？
详细介绍一下



- `listener` (监听 Socket)：它是一个特殊的 Socket，它不代表任何具体的连接。它只负责**坐在门口**（监听端口）。
- `socket` (已连接 Socket)：这是 `accept` 返回的。它代表了一条**真正打通的、点对点的** TCP 虚拟电路
- 一个服务器如果有 1000 个 用户在线 ， 它会有1001个 Socket 1个监听+1000个干活
- 任何一个 TCP 连接都由这五个信息唯一确定：
  1. **源 IP** (客户端的 IP) —— 你的 `addr` 里存的。
  2. **源端口** (客户端随机生成的端口，比如 54321) —— 你的 `addr` 里存的。
  3. **目的 IP** (你的服务器 IP)。
  4. **目的端口** (你的 6379)。
  5. **协议** (TCP)。

















